<div class="dashboard-grid">
  <div class="widget">
    <h3>Calendar</h3>
    <div id="calendar" style="min-height: 400px;"></div>
  </div>

  <div class="widget">
    <h3>Current Time</h3>
    <div id="clock"></div>
  </div>

  <div class="widget">
    <h3>Executive Contacts</h3>
    <ul id="contacts">
      <li>Loading...</li>
    </ul>
  </div>

  <div class="widget">
    <h3>Help</h3>
    <button onclick="location.href='/help'" title="Get Assistance">Go to Help Page</button>
  </div>
</div>

<!-- Ensure FullCalendar CSS is already included in main page -->
<!-- FullCalendar plugin needed only once -->
<script>
  function initDashboard() {
    const calendarEl = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(calendarEl, {
      plugins: [dayGridPlugin],
      initialView: 'dayGridMonth',
      height: 300,
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth'
      },
      events: [
        { title: 'Meeting', start: '2025-06-01' },
        { title: 'Code Review', start: '2025-06-03' },
        { title: 'Product Launch', start: '2025-06-07', end: '2025-06-10' }
      ],
      editable: false,
      selectable: false,
    });
    calendar.render();

    const clock = document.getElementById('clock');
    function updateClock() {
      clock.textContent = new Date().toLocaleTimeString();
    }
    setInterval(updateClock, 1000);
    updateClock();

    fetch('/api/executive-contacts')
      .then(res => {
        if (!res.ok) throw new Error('Failed to load');
        return res.json();
      })
      .then(data => {
        const list = document.getElementById('contacts');
        list.innerHTML = '';
        data.forEach(c => {
          const li = document.createElement('li');
          li.textContent = `${c.name}: ${c.phone}`;
          list.appendChild(li);
        });
      })
      .catch(() => {
        document.getElementById('contacts').innerHTML = '<li>Error loading contacts</li>';
      });
  }
</script>
